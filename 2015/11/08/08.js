"use strict";var GRAVITY=.8,TAU=2*Math.PI,MAX_PARTICLES=420,MAX_SPEED=4,PARTICLE_FREQUENCY=1,BASE_RADIUS=20,RADIUS_REDUCTION_SPEED=.05,WOBBLE_FREQUENCY=1,WOBBLE_ANGLE=TAU/10,DIRECTION_CHANGE_SPEED=.16,COLOR_CHANGE_SPEED=1,COLORS=[4265239,9116440,12796697,13867032,14603627,16775601],canvas=document.getElementById("c"),context=canvas.getContext("2d"),particles=[],getOrigin=function(){return{x:.5*window.innerWidth,y:.85*window.innerHeight}},origin=getOrigin(),frameCount=0,resize=function(){canvas.width=window.innerWidth,canvas.height=window.innerHeight,origin=getOrigin()},colorCycle=function(n,e){var t=n>>16,i=n>>8&255,a=255&n,r=COLORS[e]>>16,o=COLORS[e]>>8&255,c=255&COLORS[e];return r>t?t+=COLOR_CHANGE_SPEED:t>r&&(t-=COLOR_CHANGE_SPEED),o>i?i+=COLOR_CHANGE_SPEED:i>o&&(i-=COLOR_CHANGE_SPEED),c>a?a+=COLOR_CHANGE_SPEED:a>c&&(a-=COLOR_CHANGE_SPEED),t<<16|i<<8|a},particleFactory=function(n){var e=n||{};return e.x=origin.x,e.y=origin.y,e.color=COLORS[0],e.colorIndex=0,e.angle=Math.random()*TAU,e.radius=BASE_RADIUS,e.speed=Math.random()*MAX_SPEED+1,e},dead=function(n){return n.radius<=0||n.x<0-n.radius||n.y<0-n.radius||n.x>canvas.width+n.radius||n.y>canvas.height+n.radius},angleToTop=function(n){var e={x:canvas.width/2,y:0};return Math.atan2(e.y-n.y,e.x-n.x)},move=function(n){var e=n.angle+Math.sin(frameCount*WOBBLE_FREQUENCY)*WOBBLE_ANGLE;n.x+=Math.cos(e)*n.speed,n.y+=Math.sin(e)*n.speed-GRAVITY;var t=angleToTop(n);n.angle>t?n.angle+=DIRECTION_CHANGE_SPEED:n.angle-=DIRECTION_CHANGE_SPEED},resetAngle=function(n){return n},evolve=function(n){n.radius-=RADIUS_REDUCTION_SPEED,n.colorIndex+1<COLORS.length&&(n.color=colorCycle(n.color,n.colorIndex+1)),COLORS[n.colorIndex+1]==n.color&&n.colorIndex++},draw=function(n){n.radius>0&&(context.fillStyle="#"+n.color.toString(16),context.beginPath(),context.arc(n.x,n.y,n.radius,0,TAU,!0),context.fill())},animate=function n(e){context.clearRect(0,0,canvas.width,canvas.height);var t=particles.filter(function(n){return!dead(n)}).sort(function(n,e){return n.radius>e.radius?-1:n.radius<e.radius?1:0});if(t.forEach(draw),t.forEach(move),t.forEach(evolve),frameCount%PARTICLE_FREQUENCY==0){var i=particles.filter(dead);particles.length<MAX_PARTICLES&&0==i.length?particles.push(particleFactory()):particleFactory(particles.filter(dead)[0])}frameCount++,requestAnimationFrame(n)},activateGoo=function(){canvas.classList.toggle("gooey")},init=function(){document.getElementById("activateGoo").addEventListener("change",activateGoo),resize(),animate()},changeOrigin=function(n){origin.x=n.clientX,origin.y=n.clientY};document.addEventListener("DOMContentLoaded",init),window.addEventListener("resize",resize),canvas.addEventListener("mousedown",changeOrigin),canvas.addEventListener("mousemove",changeOrigin),document.addEventListener("mouseleave",function(n){origin=getOrigin()});